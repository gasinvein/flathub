app-id: net.rpcs3.RPCS3
runtime: org.kde.Platform
sdk: org.kde.Sdk
runtime-version: "5.12"
command: rpcs3
rename-desktop-file: rpcs3.desktop
rename-icon: rpcs3
finish-args:
  - --device=all
  - --share=ipc
  - --socket=x11
  - --socket=wayland
  - --socket=pulseaudio
cleanup:
  - /lib/*.a
  - /lib/*.la
  - /include
  - /lib/pkgconfig
  - /lib/cmake
  - /share/man
modules:
  - shared-modules/glu/glu-9.0.0.json
  - shared-modules/glew/glew.json
  - shared-modules/udev/udev-175.json

  - name: evdev
    config-opts:
      - --disable-static
    sources:
      - type: archive
        url: "https://freedesktop.org/software/libevdev/libevdev-1.5.7.tar.xz"
        sha256: a1e59e37a2f0d397ffd7e83b73af0e638db83b8dd08902ef0f651a21cc1dd422
    cleanup:
      - /bin

  - name: openal
    buildsystem: cmake-ninja
    builddir: true
    config-opts:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
    sources:
      - type: archive
        url: "http://http.debian.net/debian/pool/main/o/openal-soft/openal-soft_1.17.2.orig.tar.bz2"
        sha256: a341f8542f1f0b8c65241a17da13d073f18ec06658e1a1606a8ecc8bbc2b3314
    cleanup:
      - /bin
      - /share

  - name: rpcs3
    buildsystem: cmake-ninja
    builddir: true
    config-opts:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
      - -DUSE_ALSA=OFF
      - -DUSE_SYSTEM_LIBPNG=ON
    sources:
      - type: git
        url: "https://github.com/RPCS3/rpcs3.git"
    cleanup:
      - /include/llvm
      - /include/llvm-c
      - /bin/llvm*

  - name: rpcs3-metadata
    buildsystem: simple
    build-commands:
      - install -Dm644 net.rpcs3.RPCS3.appdata.xml -t /app/share/appdata/
    sources:
      - type: file
        path: net.rpcs3.RPCS3.appdata.xml
